# docker-compose.override.yml - Local overrides (Coolify/VPS deployment)
#
# SECURITY: All secrets MUST be provided via environment variables.
# Do NOT add default values for secrets here.
#
# Required environment variables (set in Coolify or host):
#   - POSTGRES_PASSWORD
#   - NEXTAUTH_SECRET (generate: openssl rand -base64 32)
#   - EINVOICE_KEY_SECRET (generate: openssl rand -hex 32)
#   - DATABASE_URL (or use constructed URL below)
#
# For production, use docker-compose.prod.yml instead.

services:
  fiskai-db:
    environment:
      POSTGRES_USER: ${POSTGRES_USER:-fiskai}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:?POSTGRES_PASSWORD is required - set in environment}
      POSTGRES_DB: ${POSTGRES_DB:-fiskai}

  fiskai-app:
    environment:
      - DATABASE_URL=${DATABASE_URL:?DATABASE_URL is required - set in environment}
      - NEXTAUTH_URL=${NEXTAUTH_URL:?NEXTAUTH_URL is required - set in environment}
      - NEXTAUTH_SECRET=${NEXTAUTH_SECRET:?NEXTAUTH_SECRET is required - generate with: openssl rand -base64 32}
      - NEXT_PUBLIC_APP_NAME=${NEXT_PUBLIC_APP_NAME:-FiskAI}
      - NEXT_PUBLIC_APP_URL=${NEXT_PUBLIC_APP_URL:?NEXT_PUBLIC_APP_URL is required}
      - EINVOICE_KEY_SECRET=${EINVOICE_KEY_SECRET:?EINVOICE_KEY_SECRET is required - generate with: openssl rand -hex 32}
      # AUTH_TRUST_HOST: Only enable behind a trusted reverse proxy with Host validation
      # - AUTH_TRUST_HOST=true
    ports:
      - "${APP_PORT:-3002}:3000"
