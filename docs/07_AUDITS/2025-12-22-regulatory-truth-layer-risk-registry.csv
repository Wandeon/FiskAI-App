id,risk,severity,likelihood,impact,area,evidence,mitigation,owner,status
R-CRIT-01,AppliesWhen DSL mismatch breaks rule evaluation,Critical,High,Critical,Rules DSL,"src/lib/regulatory-truth/prompts/index.ts:121 src/lib/regulatory-truth/dsl/applies-when.ts:14 src/app/api/rules/evaluate/route.ts:66","Align DSL format and enforce validation on write; migrate existing rules",TBD,Open
R-CRIT-02,Composer conflicts lack itemA/itemB references,Critical,High,Critical,Conflicts,"src/lib/regulatory-truth/agents/composer.ts:90 src/lib/regulatory-truth/agents/arbiter.ts:94 src/app/api/admin/regulatory-truth/conflicts/[id]/resolve/route.ts:24","Populate itemAId/itemBId or introduce pointer-based conflict resolution",TBD,Open
R-CRIT-03,Manual trigger endpoints are placeholders,Critical,High,High,Operations,"src/app/api/admin/regulatory-truth/trigger/route.ts:25 src/app/api/admin/regulatory-truth/sources/[id]/check/route.ts:35","Wire triggers to actual pipeline execution and return real job IDs",TBD,Open
R-HIGH-04,Document updates at same URL not re-fetched,High,High,High,Discovery,"prisma/schema.prisma:1718 src/lib/regulatory-truth/agents/sentinel.ts:252","Re-scan known URLs on schedule; re-queue when hash changes",TBD,Open
R-HIGH-05,Monitoring script uses wrong runSentinel signature,High,High,Medium,Monitoring,"src/lib/regulatory-truth/scripts/monitor.ts:125 src/lib/regulatory-truth/agents/sentinel.ts:184","Fix signature mismatch or add source-level sentinel API",TBD,Open
R-HIGH-06,Audit log missing evidence and conflict creation,High,High,High,Audit,"src/lib/regulatory-truth/utils/audit-log.ts:5 src/lib/regulatory-truth/agents/sentinel.ts:306 src/lib/regulatory-truth/agents/composer.ts:90","Add audit log calls for evidence fetch, conflict creation, admin actions",TBD,Open
R-HIGH-07,Agent runner lacks timeout/abort,High,Medium,High,Agents,"src/lib/regulatory-truth/agents/runner.ts:113","Add request timeouts, aborts, and stale run cleanup",TBD,Open
R-HIGH-08,Release approvals sourced from LLM output,High,Medium,High,Releases,"src/lib/regulatory-truth/agents/releaser.ts:221 prisma/schema.prisma:1859","Populate approvedBy from actual human approvals only",TBD,Open
R-MED-09,Authority derivation ignores source hierarchy,Medium,Medium,Medium,Authority,"src/lib/regulatory-truth/utils/authority.ts:9 prisma/schema.prisma:1658","Map hierarchy to AuthorityLevel; use source.hierarchy",TBD,Open
R-MED-10,Rate limiter ignores maxRequestsPerMinute/maxConcurrent,Medium,Medium,Medium,Discovery,"src/lib/regulatory-truth/utils/rate-limiter.ts:3","Implement per-minute counters and concurrency gates",TBD,Open
R-MED-11,Evaluate endpoint loads all published rules,Medium,Medium,Medium,API,"src/app/api/rules/evaluate/route.ts:32","Add filtering and batch evaluation for scale",TBD,Open
R-MED-12,AppliesWhen between allows missing bounds,Medium,Low,Medium,Rules DSL,"src/lib/regulatory-truth/dsl/applies-when.ts:41","Require at least one bound or reject invalid predicates",TBD,Open
R-MED-13,Evidence hasChanged/changeSummary not set,Medium,Medium,Medium,Audit,"prisma/schema.prisma:1732 src/lib/regulatory-truth/agents/sentinel.ts:306","Set change metadata when evidence is created",TBD,Open
R-MED-14,Search endpoint lacks enum validation,Medium,Low,Medium,API,"src/app/api/rules/search/route.ts:36 prisma/schema.prisma:1792","Validate query params and return 400 on invalid enums",TBD,Open
R-LOW-15,AI provider mismatch vs audit request,Low,Medium,Low,Ops/Docs,"src/lib/regulatory-truth/agents/runner.ts:12 docs/audits/2025-12-22-regulatory-truth-layer-audit-request.md","Align docs with implementation or implement Anthropic client",TBD,Open
