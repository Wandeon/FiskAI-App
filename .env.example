# ═══════════════════════════════════════════════════════════════
# FiskAI Environment Configuration Template
# ═══════════════════════════════════════════════════════════════
#
# SECURITY NOTICE:
# This file contains placeholder values that MUST be replaced before deployment.
# Never use placeholder values in production - they are intentionally invalid.
#
# To set up your environment:
# 1. Copy this file: cp .env.example .env
# 2. Replace ALL placeholder values with real credentials
# 3. Generate secrets using: openssl rand -hex 32
# 4. Validate before deployment: ./scripts/validate-env.sh
#
# Placeholder patterns to replace:
# - REPLACE_ME_* or REPLACE_with_* → Use secure values
# - GENERATE_WITH_* → Generate using the specified command
# - *_your_* → Obtain from the respective service dashboard
#
# NEVER commit .env to version control - it is git-ignored for security.
#
# ═══════════════════════════════════════════════════════════════
# REQUIRED - Application will not start without these
# ═══════════════════════════════════════════════════════════════

# Database configuration (required)
# Used for PostgreSQL container and connection string
POSTGRES_USER=fiskai
POSTGRES_PASSWORD=REPLACE_ME_WITH_SECURE_PASSWORD_MIN_32_CHARS
POSTGRES_DB=fiskai
DATABASE_URL=postgresql://fiskai:${POSTGRES_PASSWORD}@fiskai-db:5432/fiskai?schema=public

# Authentication (required)
# Generate with: openssl rand -hex 32
# NEXTAUTH_URL: Your production domain
NEXTAUTH_URL=https://your-app.example.com
NEXTAUTH_SECRET=GENERATE_WITH_openssl_rand_hex_32

# Encryption (required)
# Generate with: openssl rand -hex 32
# Used for encrypting sensitive invoice data
EINVOICE_KEY_SECRET=GENERATE_WITH_openssl_rand_hex_32

# OAuth State Signing (required for email OAuth)
# Generate with: openssl rand -hex 32
# Used for HMAC signing OAuth state parameters to prevent tampering
STATE_SECRET=GENERATE_WITH_openssl_rand_hex_32

# Redis (required for job queues)
REDIS_URL=redis://localhost:6379

# ═══════════════════════════════════════════════════════════════
# OPTIONAL - Defaults are provided, override as needed
# ═══════════════════════════════════════════════════════════════

# Application runtime (optional)
APP_PORT=3002
NEXT_PUBLIC_APP_NAME=FiskAI
NEXT_PUBLIC_APP_URL=https://your-app.example.com

# Worker config (optional - defaults shown)
WORKER_CONCURRENCY=2
BULLMQ_PREFIX=fiskai
JOB_RETENTION_HOURS=24

# Watchdog Configuration (optional - defaults shown)
WATCHDOG_ENABLED=true
WATCHDOG_TIMEZONE=Europe/Zagreb

# Timing (optional - defaults shown)
SCOUT_START_HOUR=6
SCOUT_TIMEOUT_MINUTES=30
SCRAPE_TIMEOUT_HOUR=8

# Thresholds (optional - defaults shown)
STALE_SOURCE_WARNING_DAYS=7
STALE_SOURCE_CRITICAL_DAYS=14
FAILURE_RATE_WARNING=0.3
FAILURE_RATE_CRITICAL=0.5
CONFIDENCE_WARNING=0.85
CONFIDENCE_CRITICAL=0.75
REJECTION_RATE_WARNING=0.4
REJECTION_RATE_CRITICAL=0.6

# Article Agent Thresholds (optional - defaults shown)
ARTICLE_AGENT_PASS_THRESHOLD=0.8
ARTICLE_AGENT_FAIL_THRESHOLD=0.5
ARTICLE_AGENT_MAX_ITERATIONS=3

# Visible Reasoning UX (optional)
# Enable/disable reasoning UX
REASONING_UX_ENABLED=false

# Reasoning mode: off | shadow | live
# - off: Legacy pipeline only
# - shadow: Both pipelines, legacy serves, new logs traces (mandatory before live)
# - live: New reasoning pipeline serves responses
REASONING_MODE=off

# Beta rollout percentage (0-100)
# Only applies when REASONING_MODE=live
REASONING_BETA_PERCENTAGE=0

# Fiscal Demo Mode (optional)
# Set to "true" to bypass real FINA API for testing
FISCAL_DEMO_MODE=true

# ═══════════════════════════════════════════════════════════════
# FEATURE: AI/OCR (required only if using AI features)
# ═══════════════════════════════════════════════════════════════

# OpenAI API (get from https://platform.openai.com/api-keys)
# SECURITY: Never prefix these with NEXT_PUBLIC_ - they must remain server-side only
OPENAI_API_KEY=sk_REPLACE_with_real_key_from_openai_dashboard

# DeepSeek API (optional - alternative to OpenAI)
# Get from https://platform.deepseek.com
DEEPSEEK_API_KEY=

# Article Agent (Ollama Cloud) - optional
# Get API key from https://ollama.com/settings/keys
OLLAMA_API_KEY=
OLLAMA_ENDPOINT=https://ollama.com
OLLAMA_MODEL=qwen3-next:80b
OLLAMA_EMBED_MODEL=nomic-embed-text
OLLAMA_EMBED_DIMS=768

# ═══════════════════════════════════════════════════════════════
# FEATURE: Email Sending (required only if using email features)
# ═══════════════════════════════════════════════════════════════

# Resend API (get from https://resend.com/dashboard)
# Required for transactional emails
RESEND_API_KEY=re_REPLACE_with_real_key_from_resend_dashboard
RESEND_FROM_EMAIL=noreply@yourdomain.com

# Webhook secret for email tracking (get from Resend dashboard)
RESEND_WEBHOOK_SECRET=whsec_REPLACE_with_real_webhook_secret

# SMTP (optional - alternative to Resend)
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=
SMTP_FROM=noreply@fiskai.hr

# ═══════════════════════════════════════════════════════════════
# FEATURE: Email Import (required only if using email import)
# ═══════════════════════════════════════════════════════════════

# Gmail (reuse existing Google OAuth if available)
# GOOGLE_CLIENT_ID and GOOGLE_CLIENT_SECRET already used for auth

# Microsoft/Outlook
# Get from https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps
MICROSOFT_CLIENT_ID=
MICROSOFT_CLIENT_SECRET=

# ═══════════════════════════════════════════════════════════════
# FEATURE: WebAuthn/Passkeys (required only if using passkeys)
# ═══════════════════════════════════════════════════════════════

# WebAuthn configuration
# RP_ID should match your domain
WEBAUTHN_RP_ID=erp.metrica.hr
WEBAUTHN_RP_NAME=FiskAI

# ═══════════════════════════════════════════════════════════════
# FEATURE: Bank Sync (required only if using bank integration)
# ═══════════════════════════════════════════════════════════════

# GoCardless (get from https://bankaccountdata.gocardless.com)
BANK_SYNC_PROVIDER=gocardless
GOCARDLESS_SECRET_ID=your_secret_id
GOCARDLESS_SECRET_KEY=your_secret_key
GOCARDLESS_BASE_URL=https://bankaccountdata.gocardless.com/api/v2

# ═══════════════════════════════════════════════════════════════
# FEATURE: Cloud Storage (required only if using file storage)
# ═══════════════════════════════════════════════════════════════

# Cloudflare R2 Storage (get from https://dash.cloudflare.com)
R2_ACCOUNT_ID=
R2_ACCESS_KEY_ID=
R2_SECRET_ACCESS_KEY=
R2_BUCKET_NAME=fiskai-documents

# ═══════════════════════════════════════════════════════════════
# FEATURE: Fiscalisation (required only if using Croatian fiscalisation)
# ═══════════════════════════════════════════════════════════════

# Fiscalisation certificate encryption (32 bytes as 64 hex chars)
# Generate with: openssl rand -hex 32
FISCAL_CERT_KEY=

# ═══════════════════════════════════════════════════════════════
# FEATURE: Stripe Billing (required only if using Stripe billing)
# ═══════════════════════════════════════════════════════════════

# Stripe API (get from https://dashboard.stripe.com/apikeys)
STRIPE_SECRET_KEY=sk_REPLACE_with_real_key_from_stripe_dashboard
STRIPE_WEBHOOK_SECRET=whsec_REPLACE_with_real_webhook_secret

# Stripe Price IDs (create in Stripe dashboard)
STRIPE_PRICE_PAUSALNI=price_xxx  # 39 EUR/month
STRIPE_PRICE_STANDARD=price_xxx  # 99 EUR/month
STRIPE_PRICE_PRO=price_xxx       # 199 EUR/month

# ═══════════════════════════════════════════════════════════════
# FEATURE: Analytics (optional - for usage tracking)
# ═══════════════════════════════════════════════════════════════

# PostHog (get from https://posthog.com)
NEXT_PUBLIC_POSTHOG_KEY=
NEXT_PUBLIC_POSTHOG_HOST=https://eu.i.posthog.com

# ═══════════════════════════════════════════════════════════════
# FEATURE: Bot Protection (optional - recommended for production)
# ═══════════════════════════════════════════════════════════════

# Cloudflare Turnstile (get from https://dash.cloudflare.com/?to=/:account/turnstile)
NEXT_PUBLIC_TURNSTILE_SITE_KEY=
TURNSTILE_SECRET_KEY=

# ═══════════════════════════════════════════════════════════════
# FEATURE: Error Tracking (optional - recommended for production)
# ═══════════════════════════════════════════════════════════════

# Sentry (get from https://sentry.io/settings/projects/your-project/keys/)
SENTRY_DSN=https://xxxxx@xxxxx.ingest.sentry.io/xxxxx
NEXT_PUBLIC_SENTRY_DSN=https://xxxxx@xxxxx.ingest.sentry.io/xxxxx
SENTRY_ORG=your-org
SENTRY_PROJECT=fiskai

# Auth token for source map uploads (create at https://sentry.io/settings/auth-tokens/)
SENTRY_AUTH_TOKEN=

# ═══════════════════════════════════════════════════════════════
# FEATURE: Cron Jobs (required only if using scheduled jobs)
# ═══════════════════════════════════════════════════════════════

# Cron Protection - for authorizing scheduled job requests
# Generate with: openssl rand -hex 32
CRON_SECRET=

# ═══════════════════════════════════════════════════════════════
# FEATURE: Monitoring & Alerting (optional)
# ═══════════════════════════════════════════════════════════════

# Admin alerting
ADMIN_ALERT_EMAIL=admin@example.com

# Slack notifications (get webhook from https://api.slack.com/messaging/webhooks)
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/xxx/yyy/zzz
SLACK_CHANNEL=#fiskai-alerts

# External monitoring integration
# Set this to send alerts to external monitoring services (Uptime Robot, Better Uptime, PagerDuty, etc.)
# The endpoint receives POST requests with JSON payload containing event_type, severity, message, etc.
SYSTEM_STATUS_WEBHOOK_URL=
